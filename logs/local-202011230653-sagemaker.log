20:C 22 Nov 2020 20:09:35.784 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
20:C 22 Nov 2020 20:09:35.784 # Redis version=5.0.8, bits=64, commit=00000000, modified=0, pid=20, just started
20:C 22 Nov 2020 20:09:35.784 # Configuration loaded
                _._                                                  
           _.-``__ ''-._                                             
      _.-``    `.  `_.  ''-._           Redis 5.0.8 (00000000/0) 64 bit
  .-`` .-```.  ```\/    _.,_ ''-._                                   
 (    '      ,       .-`  | `,    )     Running in standalone mode
 |`-._`-...-` __...-.``-._|'` _.-'|     Port: 6379
 |    `-._   `._    /     _.-'    |     PID: 20
  `-._    `-._  `-./  _.-'    _.-'                                   
 |`-._`-._    `-.__.-'    _.-'_.-'|                                  
 |    `-._`-._        _.-'_.-'    |           http://redis.io        
  `-._    `-._`-.__.-'_.-'    _.-'                                   
 |`-._`-._    `-.__.-'    _.-'_.-'|                                  
 |    `-._`-._        _.-'_.-'    |                                  
  `-._    `-._`-.__.-'_.-'    _.-'                                   
      `-._    `-.__.-'    _.-'                                       
          `-._        _.-'                                           
              `-.__.-'                                               

20:M 22 Nov 2020 20:09:35.785 # WARNING: The TCP backlog setting of 512 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.
20:M 22 Nov 2020 20:09:35.785 # Server initialized
20:M 22 Nov 2020 20:09:35.785 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
20:M 22 Nov 2020 20:09:35.786 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.
20:M 22 Nov 2020 20:09:35.786 * Ready to accept connections
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:523: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:524: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:532: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
2020-11-22 20:09:37,866 sagemaker-containers INFO     Imported framework sagemaker_tensorflow_container.training
2020-11-22 20:09:38,130 sagemaker-containers INFO     Invoking user script

Training Env:

{
    "additional_framework_parameters": {
        "sagemaker_estimator": "RLEstimator"
    },
    "channel_input_dirs": {},
    "current_host": "algo-1-cnzj6",
    "framework_module": "sagemaker_tensorflow_container.training:main",
    "hosts": [
        "algo-1-cnzj6"
    ],
    "hyperparameters": {
        "s3_bucket": "bucket",
        "s3_prefix": "current",
        "aws_region": "us-east-1",
        "model_metadata_s3_key": "s3://bucket/custom_files/model_metadata.json",
        "RLCOACH_PRESET": "deepracer",
        "batch_size": 256,
        "beta_entropy": 0.01,
        "discount_factor": 0.999,
        "e_greedy_value": 0.05,
        "epsilon_steps": 10000,
        "exploration_type": "categorical",
        "loss_type": "huber",
        "lr": 1e-05,
        "num_episodes_between_training": 20,
        "num_epochs": 10,
        "stack_size": 1,
        "term_cond_avg_score": 100000.0,
        "term_cond_max_episodes": 1000000,
        "pretrained_s3_bucket": "bucket",
        "pretrained_s3_prefix": "rl-deepracer-pretrained"
    },
    "input_config_dir": "/opt/ml/input/config",
    "input_data_config": {},
    "input_dir": "/opt/ml/input",
    "is_master": true,
    "job_name": "current",
    "log_level": 20,
    "master_hostname": "algo-1-cnzj6",
    "model_dir": "/opt/ml/model",
    "module_dir": "s3://bucket/current/source/sourcedir.tar.gz",
    "module_name": "training_worker",
    "network_interface_name": "eth0",
    "num_cpus": 16,
    "num_gpus": 3,
    "output_data_dir": "/opt/ml/output/data",
    "output_dir": "/opt/ml/output",
    "output_intermediate_dir": "/opt/ml/output/intermediate",
    "resource_config": {
        "current_host": "algo-1-cnzj6",
        "hosts": [
            "algo-1-cnzj6"
        ]
    },
    "user_entry_point": "training_worker.py"
}

Environment variables:

SM_HOSTS=["algo-1-cnzj6"]
SM_NETWORK_INTERFACE_NAME=eth0
SM_HPS={"RLCOACH_PRESET":"deepracer","aws_region":"us-east-1","batch_size":256,"beta_entropy":0.01,"discount_factor":0.999,"e_greedy_value":0.05,"epsilon_steps":10000,"exploration_type":"categorical","loss_type":"huber","lr":1e-05,"model_metadata_s3_key":"s3://bucket/custom_files/model_metadata.json","num_episodes_between_training":20,"num_epochs":10,"pretrained_s3_bucket":"bucket","pretrained_s3_prefix":"rl-deepracer-pretrained","s3_bucket":"bucket","s3_prefix":"current","stack_size":1,"term_cond_avg_score":100000.0,"term_cond_max_episodes":1000000}
SM_USER_ENTRY_POINT=training_worker.py
SM_FRAMEWORK_PARAMS={"sagemaker_estimator":"RLEstimator"}
SM_RESOURCE_CONFIG={"current_host":"algo-1-cnzj6","hosts":["algo-1-cnzj6"]}
SM_INPUT_DATA_CONFIG={}
SM_OUTPUT_DATA_DIR=/opt/ml/output/data
SM_CHANNELS=[]
SM_CURRENT_HOST=algo-1-cnzj6
SM_MODULE_NAME=training_worker
SM_LOG_LEVEL=20
SM_FRAMEWORK_MODULE=sagemaker_tensorflow_container.training:main
SM_INPUT_DIR=/opt/ml/input
SM_INPUT_CONFIG_DIR=/opt/ml/input/config
SM_OUTPUT_DIR=/opt/ml/output
SM_NUM_CPUS=16
SM_NUM_GPUS=3
SM_MODEL_DIR=/opt/ml/model
SM_MODULE_DIR=s3://bucket/current/source/sourcedir.tar.gz
SM_TRAINING_ENV={"additional_framework_parameters":{"sagemaker_estimator":"RLEstimator"},"channel_input_dirs":{},"current_host":"algo-1-cnzj6","framework_module":"sagemaker_tensorflow_container.training:main","hosts":["algo-1-cnzj6"],"hyperparameters":{"RLCOACH_PRESET":"deepracer","aws_region":"us-east-1","batch_size":256,"beta_entropy":0.01,"discount_factor":0.999,"e_greedy_value":0.05,"epsilon_steps":10000,"exploration_type":"categorical","loss_type":"huber","lr":1e-05,"model_metadata_s3_key":"s3://bucket/custom_files/model_metadata.json","num_episodes_between_training":20,"num_epochs":10,"pretrained_s3_bucket":"bucket","pretrained_s3_prefix":"rl-deepracer-pretrained","s3_bucket":"bucket","s3_prefix":"current","stack_size":1,"term_cond_avg_score":100000.0,"term_cond_max_episodes":1000000},"input_config_dir":"/opt/ml/input/config","input_data_config":{},"input_dir":"/opt/ml/input","is_master":true,"job_name":"current","log_level":20,"master_hostname":"algo-1-cnzj6","model_dir":"/opt/ml/model","module_dir":"s3://bucket/current/source/sourcedir.tar.gz","module_name":"training_worker","network_interface_name":"eth0","num_cpus":16,"num_gpus":3,"output_data_dir":"/opt/ml/output/data","output_dir":"/opt/ml/output","output_intermediate_dir":"/opt/ml/output/intermediate","resource_config":{"current_host":"algo-1-cnzj6","hosts":["algo-1-cnzj6"]},"user_entry_point":"training_worker.py"}
SM_USER_ARGS=["--RLCOACH_PRESET","deepracer","--aws_region","us-east-1","--batch_size","256","--beta_entropy","0.01","--discount_factor","0.999","--e_greedy_value","0.05","--epsilon_steps","10000","--exploration_type","categorical","--loss_type","huber","--lr","1e-05","--model_metadata_s3_key","s3://bucket/custom_files/model_metadata.json","--num_episodes_between_training","20","--num_epochs","10","--pretrained_s3_bucket","bucket","--pretrained_s3_prefix","rl-deepracer-pretrained","--s3_bucket","bucket","--s3_prefix","current","--stack_size","1","--term_cond_avg_score","100000.0","--term_cond_max_episodes","1000000"]
SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate
SM_HP_S3_BUCKET=bucket
SM_HP_S3_PREFIX=current
SM_HP_AWS_REGION=us-east-1
SM_HP_MODEL_METADATA_S3_KEY=s3://bucket/custom_files/model_metadata.json
SM_HP_RLCOACH_PRESET=deepracer
SM_HP_BATCH_SIZE=256
SM_HP_BETA_ENTROPY=0.01
SM_HP_DISCOUNT_FACTOR=0.999
SM_HP_E_GREEDY_VALUE=0.05
SM_HP_EPSILON_STEPS=10000
SM_HP_EXPLORATION_TYPE=categorical
SM_HP_LOSS_TYPE=huber
SM_HP_LR=1e-05
SM_HP_NUM_EPISODES_BETWEEN_TRAINING=20
SM_HP_NUM_EPOCHS=10
SM_HP_STACK_SIZE=1
SM_HP_TERM_COND_AVG_SCORE=100000.0
SM_HP_TERM_COND_MAX_EPISODES=1000000
SM_HP_PRETRAINED_S3_BUCKET=bucket
SM_HP_PRETRAINED_S3_PREFIX=rl-deepracer-pretrained
PYTHONPATH=/usr/local/bin:/opt/amazon:/opt/ml/code:/usr/lib/python36.zip:/usr/lib/python3.6:/usr/lib/python3.6/lib-dynload:/usr/local/lib/python3.6/dist-packages:/usr/lib/python3/dist-packages

Invoking script with the following command:

/usr/bin/python training_worker.py --RLCOACH_PRESET deepracer --aws_region us-east-1 --batch_size 256 --beta_entropy 0.01 --discount_factor 0.999 --e_greedy_value 0.05 --epsilon_steps 10000 --exploration_type categorical --loss_type huber --lr 1e-05 --model_metadata_s3_key s3://bucket/custom_files/model_metadata.json --num_episodes_between_training 20 --num_epochs 10 --pretrained_s3_bucket bucket --pretrained_s3_prefix rl-deepracer-pretrained --s3_bucket bucket --s3_prefix current --stack_size 1 --term_cond_avg_score 100000.0 --term_cond_max_episodes 1000000


S3 bucket: bucket 
 S3 prefix: current 
 S3 endpoint URL: http://minio:9000
Initializing SageS3Client...
Successfully downloaded model metadata from custom_files/model_metadata.json.
Sensor list ['STEREO_CAMERAS', 'SECTOR_LIDAR'], network DEEP_CONVOLUTIONAL_NETWORK_SHALLOW, simapp_version 2.0
Loaded action space from file: [{'steering_angle': -30.0, 'speed': 1.5, 'index': 0}, {'steering_angle': -13.7, 'speed': 2.2, 'index': 1}, {'steering_angle': -4.0, 'speed': 1.9, 'index': 2}, {'steering_angle': -2.7, 'speed': 3.7, 'index': 3}, {'steering_angle': 0, 'speed': 5.0, 'index': 4}, {'steering_angle': 0, 'speed': 4.3, 'index': 5}, {'steering_angle': 3.0, 'speed': 3.2, 'index': 6}, {'steering_angle': 3.7, 'speed': 2.5, 'index': 7}, {'steering_angle': 12.0, 'speed': 2.0, 'index': 8}, {'steering_angle': 30.0, 'speed': 1.5, 'index': 9}]
Using the following hyper-parameters
{
  "batch_size": 256,
  "beta_entropy": 0.01,
  "discount_factor": 0.999,
  "e_greedy_value": 0.05,
  "epsilon_steps": 10000,
  "exploration_type": "categorical",
  "loss_type": "huber",
  "lr": 1e-05,
  "num_episodes_between_training": 20,
  "num_epochs": 10,
  "stack_size": 1,
  "term_cond_avg_score": 100000.0,
  "term_cond_max_episodes": 1000000
}
Uploaded hyperparameters.json to S3
Uploaded IP address information to S3: 172.18.0.5
Sensor list ['STEREO_CAMERAS', 'SECTOR_LIDAR'], network DEEP_CONVOLUTIONAL_NETWORK_SHALLOW, simapp_version 2.0
Unable to find best model data, using last model
## Creating graph - name: MultiAgentGraphManager
## Start physics before creating graph
## Create graph
## Creating agent - name: agent
## Created agent: agent
## Stop physics after creating graph
## Creating session
Checkpoint> Restoring from path=./pretrained_checkpoint/667_Step-518667.ckpt
Checkpoint> Saving in path=['./checkpoint/668_Step-0.ckpt']
Uploaded 3 files for checkpoint 668 in 0.43 seconds
saved intermediate frozen graph: current/model/model_668.pb
Unable to find best model data, using last model
Unable to find the best checkpoint number. Getting the last checkpoint number
Unable to find best model data, using last model
Unable to find the last checkpoint number.
Unable to find best model data, using last model
Unable to find the last checkpoint number.
Best checkpoint number: -1, Last checkpoint number: -1
Copying the frozen checkpoint from ./frozen_models/agent/model_668.pb to /opt/ml/model/agent/model.pb.
Uploaded 3 files for checkpoint 668 in 0.58 seconds
saved intermediate frozen graph: current/model/model_668.pb
Unable to find best model data, using last model
Unable to find the best checkpoint number. Getting the last checkpoint number
Unable to find best model data, using last model
Unable to find the last checkpoint number.
Unable to find best model data, using last model
Unable to find the last checkpoint number.
Best checkpoint number: -1, Last checkpoint number: -1
Copying the frozen checkpoint from ./frozen_models/agent/model_668.pb to /opt/ml/model/agent/model.pb.
DoorMan: installing SIGINT, SIGTERM
Training> Name=main_level/agent, Worker=0, Episode=1, Total reward=104.66, Steps=97, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=2, Total reward=33.26, Steps=116, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=3, Total reward=505.26, Steps=385, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=4, Total reward=116.72, Steps=488, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=5, Total reward=378.76, Steps=710, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=6, Total reward=130.44, Steps=836, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=7, Total reward=461.03, Steps=1111, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=8, Total reward=424.54, Steps=1420, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=9, Total reward=82.17, Steps=1514, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=10, Total reward=472.83, Steps=1821, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=11, Total reward=75.07, Steps=1889, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=12, Total reward=469.17, Steps=2161, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=13, Total reward=65.12, Steps=2200, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=14, Total reward=71.27, Steps=2246, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=15, Total reward=384.05, Steps=2525, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=16, Total reward=14.98, Steps=2538, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=17, Total reward=396.55, Steps=2822, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=18, Total reward=157.67, Steps=2911, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=19, Total reward=483.58, Steps=3195, Training iteration=0
Training> Name=main_level/agent, Worker=0, Episode=20, Total reward=69.26, Steps=3229, Training iteration=0
Policy training> Surrogate loss=0.0014562797732651234, KL divergence=0.00027045494061894715, Entropy=0.12903928756713867, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.01126235444098711, KL divergence=0.003921169321984053, Entropy=0.12532006204128265, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.009557793848216534, KL divergence=0.0062827602960169315, Entropy=0.12404400110244751, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.024440212175250053, KL divergence=0.008808706887066364, Entropy=0.12493378669023514, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.019004400819540024, KL divergence=0.010599981993436813, Entropy=0.1256614774465561, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.015370425768196583, KL divergence=0.0119484206661582, Entropy=0.122613824903965, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.024697573855519295, KL divergence=0.013355843722820282, Entropy=0.12376538664102554, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.021099379286170006, KL divergence=0.01515371073037386, Entropy=0.12616024911403656, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.026837250217795372, KL divergence=0.016467934474349022, Entropy=0.12539918720722198, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.03219402953982353, KL divergence=0.017240136861801147, Entropy=0.12579385936260223, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/669_Step-3229.ckpt']
Uploaded 3 files for checkpoint 669 in 0.53 seconds
saved intermediate frozen graph: current/model/model_669.pb
Best checkpoint number: 668, Last checkpoint number: 668
Copying the frozen checkpoint from ./frozen_models/agent/model_668.pb to /opt/ml/model/agent/model.pb.
Training> Name=main_level/agent, Worker=0, Episode=21, Total reward=327.89, Steps=3434, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=22, Total reward=156.89, Steps=3564, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=23, Total reward=213.25, Steps=3761, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=24, Total reward=506.37, Steps=4036, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=25, Total reward=94.42, Steps=4137, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=26, Total reward=450.19, Steps=4413, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=27, Total reward=292.61, Steps=4553, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=28, Total reward=170.77, Steps=4683, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=29, Total reward=421.13, Steps=4904, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=30, Total reward=129.0, Steps=4975, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=31, Total reward=119.03, Steps=5056, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=32, Total reward=355.08, Steps=5321, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=33, Total reward=55.13, Steps=5363, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=34, Total reward=25.73, Steps=5375, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=35, Total reward=465.72, Steps=5668, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=36, Total reward=461.36, Steps=5959, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=37, Total reward=369.4, Steps=6252, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=38, Total reward=25.03, Steps=6265, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=39, Total reward=405.34, Steps=6568, Training iteration=1
Training> Name=main_level/agent, Worker=0, Episode=40, Total reward=289.89, Steps=6785, Training iteration=1
Policy training> Surrogate loss=-0.0005860601086169481, KL divergence=0.0007375339628197253, Entropy=0.13383860886096954, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.0027994948904961348, KL divergence=0.007040230091661215, Entropy=0.1339820772409439, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.017335379496216774, KL divergence=0.010439962148666382, Entropy=0.1309594064950943, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.014271236024796963, KL divergence=0.0139631861820817, Entropy=0.13291145861148834, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.01657279022037983, KL divergence=0.01623191311955452, Entropy=0.13105978071689606, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.018597088754177094, KL divergence=0.01872924342751503, Entropy=0.12975777685642242, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.018501389771699905, KL divergence=0.020218554884195328, Entropy=0.12890632450580597, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.028154198080301285, KL divergence=0.02062794752418995, Entropy=0.1281275898218155, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.026338912546634674, KL divergence=0.02269658073782921, Entropy=0.12901830673217773, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.02764422446489334, KL divergence=0.0233127661049366, Entropy=0.1277754157781601, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/670_Step-6785.ckpt']
Uploaded 3 files for checkpoint 670 in 0.56 seconds
saved intermediate frozen graph: current/model/model_670.pb
Best checkpoint number: 668, Last checkpoint number: 668
Copying the frozen checkpoint from ./frozen_models/agent/model_668.pb to /opt/ml/model/agent/model.pb.
Training> Name=main_level/agent, Worker=0, Episode=41, Total reward=425.14, Steps=7054, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=42, Total reward=515.99, Steps=7341, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=43, Total reward=398.77, Steps=7629, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=44, Total reward=504.14, Steps=7905, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=45, Total reward=500.87, Steps=8199, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=46, Total reward=501.37, Steps=8474, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=47, Total reward=158.55, Steps=8563, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=48, Total reward=348.61, Steps=8743, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=49, Total reward=83.78, Steps=8820, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=50, Total reward=497.79, Steps=9098, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=51, Total reward=492.55, Steps=9386, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=52, Total reward=486.99, Steps=9657, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=53, Total reward=479.23, Steps=9932, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=54, Total reward=296.32, Steps=10072, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=55, Total reward=402.38, Steps=10355, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=56, Total reward=475.88, Steps=10630, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=57, Total reward=132.05, Steps=10717, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=58, Total reward=443.57, Steps=10997, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=59, Total reward=386.3, Steps=11254, Training iteration=2
Training> Name=main_level/agent, Worker=0, Episode=60, Total reward=536.54, Steps=11536, Training iteration=2
Policy training> Surrogate loss=-0.0004405429936014116, KL divergence=0.0009238921920768917, Entropy=0.13136540353298187, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.012455960735678673, KL divergence=0.008387919515371323, Entropy=0.1296914964914322, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.017397211864590645, KL divergence=0.013274816796183586, Entropy=0.12844547629356384, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.01578430086374283, KL divergence=0.014335951767861843, Entropy=0.12732523679733276, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.02192334085702896, KL divergence=0.01643931306898594, Entropy=0.12857872247695923, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.01910913735628128, KL divergence=0.018307624384760857, Entropy=0.12856489419937134, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.022273607552051544, KL divergence=0.01903432607650757, Entropy=0.1273859590291977, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.023240506649017334, KL divergence=0.019941888749599457, Entropy=0.12763160467147827, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.022552916780114174, KL divergence=0.020930292084813118, Entropy=0.1266779601573944, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.027516422793269157, KL divergence=0.022110886871814728, Entropy=0.12840288877487183, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/671_Step-11536.ckpt']
Uploaded 3 files for checkpoint 671 in 0.59 seconds
saved intermediate frozen graph: current/model/model_671.pb
Best checkpoint number: 669, Last checkpoint number: 669
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'668'}
Training> Name=main_level/agent, Worker=0, Episode=61, Total reward=232.41, Steps=11718, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=62, Total reward=48.04, Steps=11759, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=63, Total reward=138.66, Steps=11884, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=64, Total reward=206.62, Steps=12038, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=65, Total reward=214.89, Steps=12191, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=66, Total reward=463.22, Steps=12494, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=67, Total reward=229.8, Steps=12646, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=68, Total reward=422.45, Steps=12907, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=69, Total reward=288.07, Steps=13083, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=70, Total reward=401.22, Steps=13385, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=71, Total reward=361.93, Steps=13578, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=72, Total reward=443.58, Steps=13878, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=73, Total reward=85.21, Steps=13934, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=74, Total reward=279.85, Steps=14126, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=75, Total reward=448.34, Steps=14406, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=76, Total reward=17.42, Steps=14424, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=77, Total reward=353.4, Steps=14655, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=78, Total reward=359.22, Steps=14892, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=79, Total reward=21.35, Steps=14907, Training iteration=3
Training> Name=main_level/agent, Worker=0, Episode=80, Total reward=115.77, Steps=15016, Training iteration=3
Policy training> Surrogate loss=-0.004986306186765432, KL divergence=0.0007446951931342483, Entropy=0.1266339123249054, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.011410708539187908, KL divergence=0.010179141536355019, Entropy=0.12310605496168137, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.01732122339308262, KL divergence=0.017462778836488724, Entropy=0.11899606883525848, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.02096826210618019, KL divergence=0.021446945145726204, Entropy=0.11922474950551987, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.02207152731716633, KL divergence=0.023995650932192802, Entropy=0.11718662828207016, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.029405955225229263, KL divergence=0.02583889476954937, Entropy=0.11773232370615005, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.028027106076478958, KL divergence=0.027705155313014984, Entropy=0.11760156601667404, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.030056960880756378, KL divergence=0.028997080400586128, Entropy=0.11622282862663269, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.024950150400400162, KL divergence=0.02913990616798401, Entropy=0.11500455439090729, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.022900082170963287, KL divergence=0.030215037986636162, Entropy=0.11708275973796844, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/672_Step-15016.ckpt']
Uploaded 3 files for checkpoint 672 in 0.49 seconds
saved intermediate frozen graph: current/model/model_672.pb
Best checkpoint number: 669, Last checkpoint number: 670
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'668'}
Training> Name=main_level/agent, Worker=0, Episode=81, Total reward=320.26, Steps=15228, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=82, Total reward=524.06, Steps=15507, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=83, Total reward=265.47, Steps=15689, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=84, Total reward=233.75, Steps=15862, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=85, Total reward=3.64, Steps=15898, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=86, Total reward=495.65, Steps=16165, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=87, Total reward=300.11, Steps=16328, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=88, Total reward=265.32, Steps=16447, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=89, Total reward=101.13, Steps=16540, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=90, Total reward=455.45, Steps=16837, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=91, Total reward=381.93, Steps=17020, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=92, Total reward=24.53, Steps=17033, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=93, Total reward=465.95, Steps=17314, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=94, Total reward=471.25, Steps=17609, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=95, Total reward=157.4, Steps=17711, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=96, Total reward=23.33, Steps=17747, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=97, Total reward=483.76, Steps=18029, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=98, Total reward=446.67, Steps=18329, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=99, Total reward=352.68, Steps=18566, Training iteration=4
Training> Name=main_level/agent, Worker=0, Episode=100, Total reward=321.08, Steps=18821, Training iteration=4
Policy training> Surrogate loss=0.00034444459015503526, KL divergence=0.0008564739837311208, Entropy=0.13021643459796906, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.011415204964578152, KL divergence=0.009628446772694588, Entropy=0.13063913583755493, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.023801084607839584, KL divergence=0.01643567532300949, Entropy=0.12881015241146088, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.021209081634879112, KL divergence=0.01979190669953823, Entropy=0.12578006088733673, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.02494366466999054, KL divergence=0.022202247753739357, Entropy=0.12505696713924408, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.018761243671178818, KL divergence=0.02397030219435692, Entropy=0.12270539999008179, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.02516232617199421, KL divergence=0.025726109743118286, Entropy=0.12238685041666031, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.030894143506884575, KL divergence=0.026586215943098068, Entropy=0.12280313670635223, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.02322610653936863, KL divergence=0.028116008266806602, Entropy=0.12283631414175034, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.02607327699661255, KL divergence=0.029409809038043022, Entropy=0.12070335447788239, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/673_Step-18821.ckpt']
Uploaded 3 files for checkpoint 673 in 0.62 seconds
saved intermediate frozen graph: current/model/model_673.pb
Best checkpoint number: 669, Last checkpoint number: 671
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'670'}
Training> Name=main_level/agent, Worker=0, Episode=101, Total reward=437.0, Steps=19112, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=102, Total reward=492.46, Steps=19397, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=103, Total reward=363.95, Steps=19656, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=104, Total reward=248.34, Steps=19846, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=105, Total reward=388.78, Steps=20122, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=106, Total reward=454.83, Steps=20400, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=107, Total reward=267.71, Steps=20544, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=108, Total reward=498.59, Steps=20823, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=109, Total reward=463.27, Steps=21119, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=110, Total reward=77.68, Steps=21167, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=111, Total reward=514.65, Steps=21450, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=112, Total reward=22.29, Steps=21462, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=113, Total reward=483.81, Steps=21745, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=114, Total reward=80.22, Steps=21794, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=115, Total reward=16.03, Steps=21806, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=116, Total reward=84.2, Steps=21854, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=117, Total reward=424.75, Steps=22154, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=118, Total reward=155.6, Steps=22275, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=119, Total reward=450.15, Steps=22569, Training iteration=5
Training> Name=main_level/agent, Worker=0, Episode=120, Total reward=441.96, Steps=22852, Training iteration=5
Policy training> Surrogate loss=-0.0066513423807919025, KL divergence=0.0009673122549429536, Entropy=0.12972548604011536, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.006885199341922998, KL divergence=0.011125719174742699, Entropy=0.12551505863666534, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.017030447721481323, KL divergence=0.01570216938853264, Entropy=0.1240590363740921, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.02328706718981266, KL divergence=0.018449878320097923, Entropy=0.12231318652629852, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.018566926941275597, KL divergence=0.02003709226846695, Entropy=0.12187747657299042, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.024396557360887527, KL divergence=0.021280337125062943, Entropy=0.12152416259050369, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.024953138083219528, KL divergence=0.021757086738944054, Entropy=0.11995037645101547, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.02155095711350441, KL divergence=0.02333844266831875, Entropy=0.11934850364923477, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.026802800595760345, KL divergence=0.02451392263174057, Entropy=0.12204261124134064, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.020935792475938797, KL divergence=0.025554196909070015, Entropy=0.12062665075063705, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/674_Step-22852.ckpt']
Uploaded 3 files for checkpoint 674 in 0.58 seconds
saved intermediate frozen graph: current/model/model_674.pb
Best checkpoint number: 669, Last checkpoint number: 672
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'671'}
Training> Name=main_level/agent, Worker=0, Episode=121, Total reward=263.17, Steps=23050, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=122, Total reward=222.43, Steps=23217, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=123, Total reward=120.53, Steps=23332, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=124, Total reward=467.82, Steps=23633, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=125, Total reward=213.0, Steps=23800, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=126, Total reward=471.7, Steps=24073, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=127, Total reward=18.89, Steps=24107, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=128, Total reward=227.97, Steps=24236, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=129, Total reward=153.96, Steps=24331, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=130, Total reward=514.36, Steps=24626, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=131, Total reward=44.33, Steps=24652, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=132, Total reward=260.39, Steps=24807, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=133, Total reward=67.89, Steps=24851, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=134, Total reward=485.17, Steps=25113, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=135, Total reward=494.24, Steps=25394, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=136, Total reward=466.21, Steps=25661, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=137, Total reward=461.74, Steps=25949, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=138, Total reward=470.29, Steps=26246, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=139, Total reward=331.18, Steps=26471, Training iteration=6
Training> Name=main_level/agent, Worker=0, Episode=140, Total reward=459.8, Steps=26746, Training iteration=6
Policy training> Surrogate loss=0.00020671487436629832, KL divergence=0.0009024879545904696, Entropy=0.13813358545303345, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.017477039247751236, KL divergence=0.009970370680093765, Entropy=0.13327470421791077, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.017527662217617035, KL divergence=0.01790418103337288, Entropy=0.13173942267894745, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.024203062057495117, KL divergence=0.0224418044090271, Entropy=0.1297248899936676, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.026503384113311768, KL divergence=0.0251142755150795, Entropy=0.12737567722797394, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.02746487967669964, KL divergence=0.026632558554410934, Entropy=0.12745559215545654, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.027853215113282204, KL divergence=0.027460521087050438, Entropy=0.12670597434043884, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.027695151045918465, KL divergence=0.028070250526070595, Entropy=0.1253717690706253, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.02685614675283432, KL divergence=0.02899659425020218, Entropy=0.12386322021484375, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.02866807021200657, KL divergence=0.029982009902596474, Entropy=0.1250486969947815, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/675_Step-26746.ckpt']
Uploaded 3 files for checkpoint 675 in 0.56 seconds
saved intermediate frozen graph: current/model/model_675.pb
Best checkpoint number: 669, Last checkpoint number: 673
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'672'}
Training> Name=main_level/agent, Worker=0, Episode=141, Total reward=526.06, Steps=27028, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=142, Total reward=518.88, Steps=27302, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=143, Total reward=211.9, Steps=27487, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=144, Total reward=408.9, Steps=27793, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=145, Total reward=475.86, Steps=28087, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=146, Total reward=385.85, Steps=28397, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=147, Total reward=397.8, Steps=28579, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=148, Total reward=483.19, Steps=28843, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=149, Total reward=323.77, Steps=29063, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=150, Total reward=59.8, Steps=29107, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=151, Total reward=519.99, Steps=29389, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=152, Total reward=255.4, Steps=29521, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=153, Total reward=434.05, Steps=29798, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=154, Total reward=254.77, Steps=29988, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=155, Total reward=345.22, Steps=30227, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=156, Total reward=128.69, Steps=30298, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=157, Total reward=101.13, Steps=30350, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=158, Total reward=190.54, Steps=30479, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=159, Total reward=446.81, Steps=30760, Training iteration=7
Training> Name=main_level/agent, Worker=0, Episode=160, Total reward=417.87, Steps=31062, Training iteration=7
Policy training> Surrogate loss=-0.0006930895615369081, KL divergence=0.001292250119149685, Entropy=0.13703277707099915, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.013298340141773224, KL divergence=0.014542515389621258, Entropy=0.1312962770462036, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.02261602133512497, KL divergence=0.02064492180943489, Entropy=0.13025164604187012, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.017450235784053802, KL divergence=0.023114386945962906, Entropy=0.12752225995063782, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.025899242609739304, KL divergence=0.02497664839029312, Entropy=0.12742739915847778, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.021278802305459976, KL divergence=0.026693686842918396, Entropy=0.12705349922180176, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.02498062513768673, KL divergence=0.028125757351517677, Entropy=0.12619668245315552, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.030426405370235443, KL divergence=0.02858084626495838, Entropy=0.12648873031139374, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.022236907854676247, KL divergence=0.028061572462320328, Entropy=0.12557996809482574, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.024707328528165817, KL divergence=0.029911525547504425, Entropy=0.12563201785087585, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/676_Step-31062.ckpt']
Uploaded 3 files for checkpoint 676 in 0.58 seconds
saved intermediate frozen graph: current/model/model_676.pb
Best checkpoint number: 669, Last checkpoint number: 674
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'673'}
Training> Name=main_level/agent, Worker=0, Episode=161, Total reward=392.17, Steps=31358, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=162, Total reward=432.42, Steps=31649, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=163, Total reward=469.1, Steps=31942, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=164, Total reward=251.81, Steps=32132, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=165, Total reward=119.63, Steps=32237, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=166, Total reward=244.48, Steps=32383, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=167, Total reward=491.93, Steps=32638, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=168, Total reward=413.52, Steps=32905, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=169, Total reward=548.48, Steps=33181, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=170, Total reward=280.19, Steps=33342, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=171, Total reward=120.51, Steps=33410, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=172, Total reward=470.61, Steps=33705, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=173, Total reward=80.28, Steps=33745, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=174, Total reward=474.17, Steps=34027, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=175, Total reward=503.12, Steps=34296, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=176, Total reward=448.3, Steps=34600, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=177, Total reward=482.81, Steps=34882, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=178, Total reward=334.61, Steps=35161, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=179, Total reward=480.4, Steps=35446, Training iteration=8
Training> Name=main_level/agent, Worker=0, Episode=180, Total reward=254.36, Steps=35622, Training iteration=8
Policy training> Surrogate loss=0.0024968988727778196, KL divergence=0.0015750802122056484, Entropy=0.12533187866210938, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.016544153913855553, KL divergence=0.013128994032740593, Entropy=0.12238752096891403, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.019024737179279327, KL divergence=0.018524207174777985, Entropy=0.12033911049365997, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.01948455534875393, KL divergence=0.021597228944301605, Entropy=0.11939162015914917, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.021808315068483353, KL divergence=0.024056052789092064, Entropy=0.11834535747766495, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.025692740455269814, KL divergence=0.025098945945501328, Entropy=0.11811814457178116, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.025534069165587425, KL divergence=0.026691477745771408, Entropy=0.11788327246904373, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.026672393083572388, KL divergence=0.02731519192457199, Entropy=0.11750759929418564, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.02434266172349453, KL divergence=0.028465842828154564, Entropy=0.11792020499706268, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.027583643794059753, KL divergence=0.028218775987625122, Entropy=0.11710014939308167, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/677_Step-35622.ckpt']
Uploaded 3 files for checkpoint 677 in 0.56 seconds
saved intermediate frozen graph: current/model/model_677.pb
Best checkpoint number: 669, Last checkpoint number: 675
Copying the frozen checkpoint from ./frozen_models/agent/model_669.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'674'}
Training> Name=main_level/agent, Worker=0, Episode=181, Total reward=299.42, Steps=35832, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=182, Total reward=76.1, Steps=35888, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=183, Total reward=110.89, Steps=36013, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=184, Total reward=451.1, Steps=36305, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=185, Total reward=373.87, Steps=36529, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=186, Total reward=305.75, Steps=36692, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=187, Total reward=149.62, Steps=36784, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=188, Total reward=492.1, Steps=37084, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=189, Total reward=475.42, Steps=37396, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=190, Total reward=483.56, Steps=37692, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=191, Total reward=228.64, Steps=37793, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=192, Total reward=522.34, Steps=38074, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=193, Total reward=520.28, Steps=38359, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=194, Total reward=440.43, Steps=38665, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=195, Total reward=35.66, Steps=38681, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=196, Total reward=473.88, Steps=38968, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=197, Total reward=90.15, Steps=39020, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=198, Total reward=457.58, Steps=39327, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=199, Total reward=121.56, Steps=39417, Training iteration=9
Training> Name=main_level/agent, Worker=0, Episode=200, Total reward=396.95, Steps=39708, Training iteration=9
Policy training> Surrogate loss=-0.0008429739973507822, KL divergence=0.0008513705688528717, Entropy=0.13021650910377502, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.014419515617191792, KL divergence=0.011921476572751999, Entropy=0.12793360650539398, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.018975429236888885, KL divergence=0.017407797276973724, Entropy=0.1253906786441803, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.017618229612708092, KL divergence=0.02059146761894226, Entropy=0.12320815026760101, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.0268943402916193, KL divergence=0.022208822891116142, Entropy=0.12418389320373535, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.02599833533167839, KL divergence=0.022636402398347855, Entropy=0.12234347313642502, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.02841292694211006, KL divergence=0.024166053161025047, Entropy=0.120721235871315, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.026610689237713814, KL divergence=0.02541879005730152, Entropy=0.12100107967853546, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.02317759022116661, KL divergence=0.02678329311311245, Entropy=0.12258801609277725, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.029046185314655304, KL divergence=0.027961434796452522, Entropy=0.12101369351148605, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/678_Step-39708.ckpt']
Uploaded 3 files for checkpoint 678 in 0.54 seconds
saved intermediate frozen graph: current/model/model_678.pb
Best checkpoint number: 676, Last checkpoint number: 676
Copying the frozen checkpoint from ./frozen_models/agent/model_676.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'675'}
Training> Name=main_level/agent, Worker=0, Episode=201, Total reward=512.84, Steps=39973, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=202, Total reward=434.52, Steps=40241, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=203, Total reward=531.08, Steps=40545, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=204, Total reward=199.45, Steps=40698, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=205, Total reward=201.16, Steps=40857, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=206, Total reward=268.22, Steps=41001, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=207, Total reward=381.18, Steps=41229, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=208, Total reward=157.56, Steps=41310, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=209, Total reward=300.21, Steps=41493, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=210, Total reward=133.95, Steps=41579, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=211, Total reward=95.85, Steps=41645, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=212, Total reward=407.52, Steps=41921, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=213, Total reward=75.57, Steps=41960, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=214, Total reward=477.4, Steps=42233, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=215, Total reward=472.0, Steps=42518, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=216, Total reward=124.97, Steps=42585, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=217, Total reward=529.42, Steps=42862, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=218, Total reward=360.73, Steps=43121, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=219, Total reward=139.65, Steps=43254, Training iteration=10
Training> Name=main_level/agent, Worker=0, Episode=220, Total reward=344.67, Steps=43451, Training iteration=10
Policy training> Surrogate loss=0.005541673861443996, KL divergence=0.0009271692833863199, Entropy=0.12120602279901505, training epoch=0, learning_rate=1e-05
Policy training> Surrogate loss=-0.015587576664984226, KL divergence=0.015490993857383728, Entropy=0.11779724061489105, training epoch=1, learning_rate=1e-05
Policy training> Surrogate loss=-0.027080092579126358, KL divergence=0.022174159064888954, Entropy=0.11749458312988281, training epoch=2, learning_rate=1e-05
Policy training> Surrogate loss=-0.02197979763150215, KL divergence=0.02493557147681713, Entropy=0.11560028046369553, training epoch=3, learning_rate=1e-05
Policy training> Surrogate loss=-0.018613193184137344, KL divergence=0.02572161890566349, Entropy=0.11648166179656982, training epoch=4, learning_rate=1e-05
Policy training> Surrogate loss=-0.02426326833665371, KL divergence=0.027869487181305885, Entropy=0.11492998152971268, training epoch=5, learning_rate=1e-05
Policy training> Surrogate loss=-0.02656780369579792, KL divergence=0.028871655464172363, Entropy=0.1150282472372055, training epoch=6, learning_rate=1e-05
Policy training> Surrogate loss=-0.02855827286839485, KL divergence=0.0290397796779871, Entropy=0.11507399380207062, training epoch=7, learning_rate=1e-05
Policy training> Surrogate loss=-0.027996212244033813, KL divergence=0.030356839299201965, Entropy=0.11514639854431152, training epoch=8, learning_rate=1e-05
Policy training> Surrogate loss=-0.03007138893008232, KL divergence=0.03200171887874603, Entropy=0.11676604300737381, training epoch=9, learning_rate=1e-05
Checkpoint> Saving in path=['./checkpoint/679_Step-43451.ckpt']
Uploaded 3 files for checkpoint 679 in 0.56 seconds
saved intermediate frozen graph: current/model/model_679.pb
Best checkpoint number: 676, Last checkpoint number: 677
Copying the frozen checkpoint from ./frozen_models/agent/model_676.pb to /opt/ml/model/agent/model.pb.
Deleting the frozen models in s3 for the iterations: {'677'}
Training> Name=main_level/agent, Worker=0, Episode=221, Total reward=306.7, Steps=43665, Training iteration=11
Training> Name=main_level/agent, Worker=0, Episode=222, Total reward=480.13, Steps=43954, Training iteration=11
Training> Name=main_level/agent, Worker=0, Episode=223, Total reward=478.77, Steps=44260, Training iteration=11
Training> Name=main_level/agent, Worker=0, Episode=224, Total reward=248.73, Steps=44444, Training iteration=11
Training> Name=main_level/agent, Worker=0, Episode=225, Total reward=491.26, Steps=44734, Training iteration=11
